<?php

use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Database\Database;
use Drupal\Core\Database\DatabaseException;
use Drupal\Core\Mail\MailManagerInterface;
use Drupal\Core\Render\RendererInterface;
use Drupal\Core\Url;
use Symfony\Component\DependencyInjection\ContainerInterface;
use Drupal\file\Entity\File;
use Drupal\Core\Database\SchemaObjectExistsException;
use Drupal\Core\Database\SchemaObjectDoesNotExistException;

/**
 * Implements hook_install().
 */
function pfe_med_connect_install() {
  pfe_med_connect_create_table();
}

/**
 * Implements hook_update_N().
 */
function pfe_med_connect_update_8001() {
  pfe_med_connect_create_table();
}

/**
 * Create the custom table.
 */
function pfe_med_connect_create_table() {
  $table_name = 'custom_table';
  $schema = \Drupal::database()->schema();

  try {
    if ($schema->tableExists($table_name)) {
      $schema->dropTable($table_name);
    }
    $schema->createTable($table_name, pfe_med_connect_get_table_schema());
    drupal_set_message('Created the custom table.');
  }
  catch (\Drupal\Core\Database\SchemaObjectExistsException $e) {
    drupal_set_message('The custom table already exists.', 'warning');
  }
  catch (\Drupal\Core\Database\SchemaObjectDoesNotExistException $e) {
    drupal_set_message('Failed to create the custom table: ' . $e->getMessage(), 'error');
  }
}
